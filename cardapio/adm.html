<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Admin - Atualizar Pre√ßos</title>
    <style>
        :root {
    --primary: #e63946;
    --success: #28a745;
    --bg: #f4f4f9;
    --text: #1d3557;
    --white: #ffffff;
    --border: #ddd;
    --shadow: rgba(0, 0, 0, 0.1);
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: var(--bg);
    align-items: center;
    min-height: 100vh;
    margin: 0;
    padding: 20px; /* Adicionado para n√£o colar nas bordas em telas pequenas */
}

.admin-container {
    background: var(--white);
    padding: 40px; /* Aumentado para dar mais respiro aos elementos */
    border-radius: 16px; /* Bordas um pouco mais arredondadas para um ar moderno */
    box-shadow: 0 10px 25px var(--shadow); /* Sombra mais suave e profunda */
    width: 100%;
    max-width: 420px;
    display: flex;
    flex-direction: column;
}
#secao-painel{
    display: none; /* Inicialmente escondido at√© o login ser bem-sucedido */
    justify-content: center;
    align-items: center;
    flex-direction: column;
    margin: 0 auto;
}

/* Espa√ßamento entre as se√ß√µes de Login e Painel */
.admin-login {
    width: 100%;
    margin-bottom: 30px;
    margin-top: 100px;

}

h2 { 
    color: var(--primary); 
    text-align: center; 
    margin-bottom: 30px;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    font-size: 1.4rem;
}

.input-group { 
    margin-bottom: 25px; 
}

label { 
    display: block; 
    margin-bottom: 10px; 
    font-weight: 600; /* Peso m√©dio para melhor leitura */
    color: var(--text); 
}
.input-wrapper {
    position: relative;
    width: 100%;
}

input {
    width: 100%;
    padding: 14px;
    /* Adicionamos espa√ßo na direita para o texto n√£o ficar por baixo do √≠cone */
    padding-right: 45px; 
    border: 2px solid var(--border);
    border-radius: 10px;
    box-sizing: border-box;
    font-size: 16px;
    transition: all 0.3s ease;
    display: block;
}
input:focus { 
    border-color: var(--primary); 
    box-shadow: 0 0 8px rgba(230, 57, 70, 0.2); /* Glow suave no foco */
    outline: none; 
}
.toggle-password {
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
    font-size: 1.2rem;
    user-select: none; /* Evita selecionar o emoji como se fosse texto */
    opacity: 0.6;
    transition: opacity 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.toggle-password:hover {
    opacity: 1;
}

button {
    width: 100%;
    padding: 16px;
    background-color: var(--success);
    color: white;
    border: none;
    border-radius: 10px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-top: 15px;
    box-shadow: 0 4px 6px rgba(40, 167, 69, 0.2);
}

button:hover { 
    background-color: #218838;
    transform: translateY(-2px); /* Efeito de levante no hover */
    box-shadow: 0 6px 12px rgba(40, 167, 69, 0.3);
}

button:active {
    transform: scale(0.98); /* Mantive o seu efeito de clique que √© excelente */
}

/* Estilo espec√≠fico para o bot√£o de login caso queira cor diferente */
.btn-login {
    background-color: var(--primary);
    box-shadow: 0 4px 6px rgba(230, 57, 70, 0.2);
}

.btn-login:hover {
    background-color: #c82333;
    box-shadow: 0 6px 12px rgba(230, 57, 70, 0.3);
}

.footer-info {
   text-align: center;
    font-size: 13px;
    color: #777;
    margin-top: 25px;
    line-height: 1.5;
}
    </style>
</head>
<body>
  <section class="section-login" id="section-login">
    <div class="admin-login">
    <div >
        <h2>Acesso Admin</h2>
       <div class="input-group">
    <label for="senha-input">Senha do Firebase:</label>
    
    <div class="input-wrapper" style="position: relative;">
        <input type="password" id="senha-input" placeholder="Digite a senha">
        
        <span id="toggle-password" onclick="alternarVisualizacao()" 
              style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%); cursor: pointer; opacity: 0.6;">
            üëÅÔ∏è
        </span>
    </div>
    </div>
        <button id="btn-login" onclick="fazerLogin()" style="background-color: var(--primary);">Entrar</button>
    </div>

  </section>
    <section id="secao-painel" >
        <div class="admin-container">
        <h2>Painel de Pre√ßos</h2>

        <button onclick="salvarPrecos()">Atualizar Card√°pio Online</button>
        
        <div class="footer-info">
            Os pre√ßos ser√£o atualizados em tempo real para os clientes.
        </div>
 </div>

    </section>
 

 <script type="module">

  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, get, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
    apiKey: "AIzaSyBPM9a1TOTiIblsvgMFInpMVUvvA3BNAuc",
    authDomain: "bc-cardapio.firebaseapp.com",
    databaseURL: "https://bc-cardapio-default-rtdb.firebaseio.com",
    projectId: "bc-cardapio",
    storageBucket: "bc-cardapio.firebasestorage.app",
    messagingSenderId: "510752314447",
    appId: "1:510752314447:web:9e7f43305130d9d834463a"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// Fun√ß√£o de Login
window.fazerLogin = async function() {
    const campoSenha = document.getElementById('senha-input');
    const senhaDigitada = campoSenha.value.trim(); // .trim() remove espa√ßos acidentais
    
    // Seleciona o bot√£o dentro da section correta
    const btn = document.querySelector('#section-login button');

    if (!senhaDigitada) return alert("Por favor, digite a senha.");

    btn.innerText = "Verificando...";
    btn.disabled = true;
    
    try {
        const senhaRef = ref(db, 'cardapio/admin_key');
        const snapshot = await get(senhaRef);
        
        if (!snapshot.exists()) {
            throw new Error("A chave 'admin_key' n√£o foi encontrada no banco.");
        }

        const senhaDoBanco = snapshot.val();

        // LOG DE SEGURAN√áA (Verifique isso no F12 do navegador)
        console.log("Digitado:", senhaDigitada);
        console.log("No Banco:", senhaDoBanco);

        // Compara convertendo ambos para string e limpando espa√ßos
        if (String(senhaDigitada) === String(senhaDoBanco).trim()) {
            // CORRE√á√ÉO DOS IDS: Aqui deve ser 'section-login' (igual ao seu HTML)
            document.getElementById('section-login').style.display = 'none';
            document.getElementById('secao-painel').style.display = 'flex';
        } else {
            alert("Senha incorreta! Verifique mai√∫sculas e min√∫sculas.");
            btn.innerText = "Entrar";
            btn.disabled = false;
        }
    } catch (error) {
        console.error("Erro detalhado:", error);
        alert("Erro ao conectar: " + error.message);
        btn.innerText = "Entrar";
        btn.disabled = false;
    }
}

// Sua fun√ß√£o de salvar pre√ßos (agora sem pedir senha novamente)
window.salvarPrecos = async function() {
    let categoriaPrompt = prompt("Categoria (1-Hamb, 2-Pizza, 3-Bebida, 4-Pastel, 5-Batata):");
    const categoriasMap = { '1': 'hamburgers', '2': 'pizzas', '3': 'bebidas', '4': 'pasteis', '5': 'batatas' };
    
    let categoria = categoriasMap[categoriaPrompt];
    if (!categoria) return alert("Categoria inv√°lida!");

    let idProduto = prompt("Digite o ID do item:");
    let novoPreco = prompt("Digite o novo pre√ßo:");

   if (idProduto && novoPreco) {
    try {
        // Acessamos o caminho direto at√© a chave 'preco'
        // Isso garante que a estrutura seja sempre ID -> preco -> valor
        await set(ref(db, `cardapio/${categoria}/${idProduto}/preco`), parseFloat(novoPreco).toFixed(2));
        
        alert("Pre√ßo atualizado com sucesso!");
    } catch (err) {
        alert("Erro ao salvar: " + err.message);
    }
}
// Fun√ß√£o para alternar a visualiza√ß√£o da senha

}
window.alternarVisualizacao = function() {
    const senhaInput = document.getElementById('senha-input');
    const toggleIcon = document.getElementById('toggle-password');
    
    if (senhaInput.type === 'password') {
        senhaInput.type = 'text';
        toggleIcon.innerText = 'üôà'; // Muda o √≠cone para indicar "esconder"
    } else {
        senhaInput.type = 'password';
        toggleIcon.innerText = 'üëÅÔ∏è'; // Volta para o √≠cone de "ver"
    }
}
</script>
</body>
</html>